#ifndef __DISTRIBUTED_COMMON_H__
#define __DISTRIBUTED_COMMON_H__

#include <h2opus/core/h2opus_defs.h>
#include <h2opus/util/gpu_err_check.h>

///////////////////////////////////////////////////////////////////////////////////
// Setting Device
///////////////////////////////////////////////////////////////////////////////////
template <int hw> inline void h2opusSetDevice(int device_id);

///////////////////////////////////////////////
// CPU
///////////////////////////////////////////////
template <> inline void h2opusSetDevice<H2OPUS_HWTYPE_CPU>(int device_id)
{
}

///////////////////////////////////////////////
// GPU
///////////////////////////////////////////////
#ifdef H2OPUS_USE_GPU
template <> inline void h2opusSetDevice<H2OPUS_HWTYPE_GPU>(int device_id)
{
    gpuErrchk(cudaSetDevice(device_id));
}
#endif

#endif
